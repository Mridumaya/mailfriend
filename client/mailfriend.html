<head>
    <title>mailfriend</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/chosen.css">
    <link rel="stylesheet" href="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/css/jquery.dataTables.css">
    <link rel="stylesheet" href="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/css/jquery.dataTables_themeroller.css">
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/flick/jquery-ui.css">
    <link href="/css/jquery.tagit.css" rel="stylesheet" type="text/css">
    <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/jquery.dataTables.min.js"></script>
    <script src="/js/tag-it.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="/js/custom.js"></script>
    <script src="/js/chosen.jquery.js"></script>
    <!-- start Mixpanel --><script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" "); for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]); mixpanel.init("f2ee79182073835b91775c9d8ddbfa92");</script><!-- end Mixpanel -->
</head>
<body>
{{> google_api_modal}}
{{> layout }}
</body>


<template name="layout">

    <nav class="navbar navbar-default navbar-blue navbar-fixed-top" role="navigation">
        {{#if hasLogin}}
        <div class="pull-right avatar">
            <img src="{{picture}}" height="44" width="44">
            <a href="#" class="logout">Logout</a>
        </div>
        {{/if}}
        <div class="container">
            <div class="brand">Mail Friend</div>
        </div>
    </nav>
    {{#if hasLogin}}
    <div class="container wrapper">
        {{#if stepIsChooseFeature}}
        {{> feature_select}}
        {{/if}}
        {{#if stepIsWelcome}}
        {{> welcome}}
        {{/if}}
        {{#if stepIsSearchQ}}
        {{> searchQ}}
        {{/if}}
        {{#if stepIsNewCampaign}}
        {{> new_campaign}}
        {{/if}}
        {{#if stepIsConfirm}}
        {{> confirm}}
        {{/if}}
    </div>
    {{else}}
    {{> login}}
    {{/if}}
    <footer></footer>
</template>


<template name="google_api_modal">
    <div id="google-api-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Google api for {{domain}}</h3>
                </div>
                <div class="modal-body">
                    <div class="input-prepend">
                        <span class="add-on">Client id:</span>
                        <input class="span4 client-id" type="text" placeholder="id">
                    </div>
                    <div class="input-prepend">
                        <span class="add-on">Client secret:</span>
                        <input class="span4 client-secret" type="text" placeholder="secret">
                    </div>
                    <div class="input-prepend">
                        <span class="add-on">Redirect URIs</span>
                        <input class="span4" disabled placeholder="{{domain}}_oauth/google?close">
                    </div>
                    <div class="input-prepend">
                        <span class="add-on">Javascript Origins</span>
                        <input class="span4" disabled placeholder="{{domain}}">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary google-api-set">set</button>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="login">
    <article>
        <div class="main">
            <div class="title">Mailfriend lets you pass the word to your friends who might actually care</div>
            <button class="btn btn-success btn-lg btn-block login add-google-oauth">Login with your Gmail account
            </button>
        </div>
    </article>
</template>

<template name="feature_select">
    <div class="row text-center" style="margin-top: 50px;">
        <h3>Welcome {{name}}</h3>
    </div>
    <div class="row feature-select">
        <div class="col-md-4">
            <button class="btn btn-default btn-lg btn-block btn-create-campaign">Create a new email campaign</button>
            <button class="btn btn-default btn-lg btn-block btn-view-campaign">View an existing campaign</button>
            <button class="btn btn-default btn-lg btn-block btn-view-messages">View incoming messages</button>
        </div>
        <div class="col-md-8">
            <div class="info">
                <h3 class="text-center">Current status:</h3>
                <ul>
                    <li> 5 people forwarded your campaign</li>
                    <li> you have 3 unread messages</li>
                    <li> etc </li>
                </ul>
            </div>
        </div>
    </div>

</template>

<template name="welcome">
    <!--<article class="welcome">-->
        <!--<h2>Welcome {{name}}</h2>-->
        <!--<h4>[Someone] would like you to spread the word about [email title]. Checkout their message</h4>-->

        <!--<div class="original-message" id="original_message">-->
            <!--{{orig_message}}-->
        <!--</div>-->
        <!--<h4>Add your own note here before sending</h4>-->
        <!--<div class="input-prepend text-left" style="margin-bottom: 10px;">-->
            <!--<span class="add-on" style="font-size: 18px;">Email Subject:</span>-->
            <!--<input style="width: 520px;" class="subject" id="subject" type="text" placeholder="Invitation" value="{{mail_title}}">-->
        <!--</div>-->
        <!--<textarea id="own_message">{{own_message}}</textarea>-->

        <!--<div class="row">-->
            <!--<label class="pull-right">Step 1 of 4</label></div>-->
        <!--<button class="btn btn-success pull-right welcome-to-searchq">Next</button>-->
    <!--</article>-->
    <!--<div class="modal fade" id="defMessageModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"-->
         <!--aria-hidden="true">-->
        <!--<div class="modal-dialog">-->
            <!--<div class="modal-content">-->
                <!--<div class="modal-header">-->
                    <!--<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>-->
                    <!--<h4 class="modal-title" id="myModalLabel">Message edit</h4>-->
                <!--</div>-->
                <!--<div class="modal-body">-->
                    <!--<p>You will need to enter password in order to edit message</p>-->

                    <!--<p class="error hide">Provided password is not valid</p>-->
                    <!--<input type="password" id="password" class="input-sm"/>-->
                    <!--<button type="button" class="btn btn-primary msg-password">Submit</button>-->
                <!--</div>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
</template>

<template name="compose">
    <button class="btn btn-small logout">Logout</button>
    <br><br>

    <h3>2. This is theoretically the message you are going to send along. Notice your friend already customized it when
        they sent it to you. Sweet. Edit it a little if you want.</h3>

    <p>(nobody is getting mailed, no funny business, promise!)</p>

    <div class="input-prepend">
        <span class="add-on">Email Subject:</span>
        <input class="span7 email-subject" type="text" placeholder="Invitation" value="{{subject}}"/>
    </div>
    <div class="alert alert-warning alert-body">Warning! Please write some text!</div>
    <div class="row">
        <div class="span8">
            <div class="summernote email-body">
            </div>
        </div>
        <div class="span8">
            <div class="summernote email-body2">
                Write some here<br><br>
                <a href="{{webUrl}}">Tell your friends</a>
            </div>
        </div>
        <div class="span8">
            <div class="alert alert-error alert-lock-message hidden">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                Wrong Password!
            </div>
            <input class="lock-message" type="checkbox"><span class="lock-message-label">lock the message</span>
            <input type="password" style="margin-bottom:0px;" class="lock-message-password input-small"
                   placeholder="Password">
            <button class="btn btn-small btn-primary lock-message-button">OK</button>
        </div>
    </div>
</template>

<template name="searchQ">
    <article class="searchq">
        <h4 style="text-align: center;">Great now lets choose some friends who may been interested in this topic. Try
            adding a few keywords, for example "art" or "cookies". Something that is specific to the original
            topic. </h4>

        <div class="row" style="margin-left:0px">
            <input type="search" class="search-query input-full" placeholder="Type in a search term"
                   value="{{searchQ}}"/>

            <p id="sq_error" class="error hidden">Please add at least one search term</p>

            <div class="row">
                <label class="pull-right" >Step 2 of 4</label></div>
            <div class="row">
                <button class="btn btn-primary search-button pull-right" type="button">
                    Search
                </button>
                <button class="btn btn-default pull-right searchq-to-welcome" style="margin-right: 10px;" type="button">
                    Back
                </button>
            </div>

        </div>
    </article>
</template>


<template name="email_draft">
    <div id="email_draft" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
            <h3>Email Content Preview</h3>
        </div>
        <div class="modal-body">
            <h4>Subject:</h4>

            <p class="draft-subject"></p>
            <h4>Body:</h4>

            <p class="draft-body"></p>
            <h4>Send To:</h4>

            <p class="draft-to"></p>
        </div>
        <div class="modal-footer">
            <button class="btn draft-close" data-dismiss="modal" aria-hidden="true">Close</button>
            <button class="btn btn-primary draft-send">Send</button>
        </div>
    </div>
</template>

<template name="new_campaign">
    <div class="row" style="margin-top: 50px;">
        <h3>Create a new campaign</h3>
    </div>
    <div class="row new-capaign">
        <div class="col-md-8">
            <input style="width: 520px;" class="subject" id="subject" type="text" placeholder="Subject:" value="{{mail_title}}">
            <textarea id="own_message">{{own_message}}</textarea>
        </div>
        <div class="col-md-4">
            <span>Share this campaign: </span>
            <a href="http://bit.ly/1fNinNZ">http://bit.ly/1fNinNZ</a>
            <ul id="tags">
                <li>test</li>
                <li>example</li>
                <li>facebook</li>
            </ul>
            <button class="btn btn-default search-tags">Search</button>
        </div>
    </div>

    {{#if showContactList}}
    {{> contact_list}}
    {{/if}}
</template>

<template name="contact_list">
    <article class="contact_list">
        <h4>These are your friends interested in: <b>{{searchQ}}</b> <a style="font-size: 15px;" href="#" data-toggle="modal" data-target="#searchTermModal">edit search term</a></h4>
        <h4>The people at the top are the most relevant. Select people using these handy buttons.</h4>

        <div class="btn-send-group">
            <div class="btn-group">
                <button class="btn btn-success sendToTop15">select the top 15</button>
            </div>
            <div class="btn-group">
                <button class="btn btn-success sendToTop30">select the top 30 relevant</button>
            </div>
            <div class="btn-group">
                <button class="btn btn-success sendToAll">select all</button>
            </div>
            <div class="btn-group">
                <button class="btn btn-success add-all-relevant">choose all relevant</button>
            </div>
        </div>
        {{#constant}}
         <select data-placeholder="Sort by people I've:" class="chosen-select" multiple style="width: 550px;">
            <option value="gmail-sent">Sent a message to in the last 3 months</option>
            <option value="gmail-received">Received a message from the last 3 months</option>
            <option value="gcontact">Added to my contact list</option>
            <option value="gmail-contacts">Click to get recipients of all your emails (Or it will only recent recipients)</option>
        </select>

        {{/constant}}

        <div class="alert alert-warning alert-contact">Warning! Select emails of friends first!</div>
        <div class="row">
            <table id="contacts" class="table table-bordered table-hover contacts">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th style="width: 80px;">Sent in last 90 days</th>
                    <th style="width: 80px;">Received in last 90 days</th>
                    <th>On Contact list</th>
                    <th>Relevant {{#if searchQ}}({{searchQ}}){{/if}}</th>
                </tr>
                </thead>
                <tbody>
                {{#each matchedContacts}}
                <tr class="contact" data-email="{{email}}">
                    <td>{{name}}</td>
                    <td>{{email}}</td>
                    <td>{{sentMessages}}</td>
                    <td>{{receivedMessages}}</td>
                    <td>{{#if isGContact}}<i class="glyphicon glyphicon-ok"></i>{{/if}}</td>
                    <td>{{#if isRelevant}}<i class="relevant-contact glyphicon glyphicon-ok"></i>{{/if}}</td>
                </tr>
                {{/each}}

                {{#each unmatchedContacts}}
                <tr class="contact" data-email="{{email}}">
                    <td>{{name}}</td>
                    <td>{{email}}</td>
                    <td>{{sentMessages}}</td>
                    <td>{{receivedMessages}}</td>
                    <td>{{#if isGContact}}<i class="glyphicon glyphicon-ok"></i>{{/if}}</td>
                    <td>{{#if isRelevant}}<i class="relevant-contact glyphicon glyphicon-ok"></i>{{/if}}</td>
                </tr>
                {{/each}}
                </tbody>
            </table>
        </div>
        <div class="clear"></div>
        <!--<div class="row">-->
            <!--<label class="pull-right" >Step 3 of 4</label></div>-->
        <div class="row">
            <button class="btn btn-primary contact-list-to-confirm pull-right"
                    type="button">Next
            </button>
            <!--<button class="btn btn-default pull-right contact-list-to-searchq" style="margin-right: 10px;"-->
                    <!--type="button">Back-->
            <!--</button>-->
        </div>
        <div class="modal fade" id="searchTermModal" tabindex="-1" role="dialog" aria-labelledby="mySearchTermLabel"
             aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="mySearchTermLabel">Edit search term</h4>
                    </div>
                    <div class="modal-body">
                        <p>Please add or change search term</p>
                        <input type="text" id="s_term" value="{{searchQ}}" />
                        <button type="button" class="btn btn-primary edit-search-term">Change</button>
                    </div>
                </div>
            </div>
        </div>
    </article>
</template>

<template name="confirm">
    <article class="confirm">
        <h4 style="text-align: center;">Almost done, please review your selection and click send</h4>

        <div class="preview">
            <h4>Subject:</h4>

            <p class="draft-subject"></p>
            <h4>Body:</h4>

            <p class="draft-body"></p>
            <h4>Send To:</h4>

            <p class="draft-to"></p>
        </div>
        <div class="row">
            <label class="pull-right" style="margin-right: 13px; margin-top: 10px;">Step 4 of 4</label></div>
        <div class="row">
            <button class="btn btn-primary pull-right draft-send" style="margin-right: 10px;" type="button">Send
            </button>
            <button class="btn btn-default pull-right confirm-to-contact-list" style="margin-right: 10px;"
                    type="button">Back
            </button>
        </div>
        <div class="row text-center success hidden">
            <h4>Your email has been sent!</h4>
            <h4>Tell your friends about this awesome app?</h4>

            <div>
                <a id="facebook" href="#" target="_blank" class="active">
                    <img src="/images/facebook_icon.png">
                </a>
                <a id="twitter" href="#" class="active">
                    <img src="/images/twitter_icon.png">
                </a>
                <a id="google" href="#" class="active">
                    <img src="/images/google_icon.png">
                </a>
                <a id="linkedin" href="#" class="active">
                    <img src="/images/linkedin_icon.png">
                </a>
            </div>
        </div>
    </article>
</template>

<template name="notfound">
    <article>
        <div class="main2">
            <h1>404 - Page Not Found</h1>
        </div>
    </article>
</template>

<template name="error">
    <article>
        <div class="main2">
            <h1>500 - Error has happen</h1>
        </div>
    </article>
</template>